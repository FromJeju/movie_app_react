{"ast":null,"code":"import _regeneratorRuntime from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/lonnie/Documents/movie_app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/lonnie/Documents/movie_app/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport Movie from './Movie';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      requestSent: false,\n      pageNum: 1,\n      movies: []\n    };\n\n    _this._handleOnScroll = function () {\n      // http://stackoverflow.com/questions/9439725/javascript-how-to-detect-if-browser-window-is-scrolled-to-bottom\n      var scrollTop = document.documentElement && document.documentElement.scrollTop || document.body.scrollTop;\n      var scrollHeight = document.documentElement && document.documentElement.scrollHeight || document.body.scrollHeight;\n      var clientHeight = document.documentElement.clientHeight || window.innerHeight;\n      var scrolledToBottom = Math.ceil(scrollTop + clientHeight) >= scrollHeight;\n\n      if (scrolledToBottom) {\n        _this._querySearchResult();\n      }\n    };\n\n    _this._querySearchResult = function () {\n      if (_this.state.requestSent) {\n        return;\n      }\n\n      _this.setState({\n        pageNum: _this.state.pageNum + 1\n      });\n\n      _this._getMovies(_this.state.pageNum);\n\n      _this.setState({\n        requestSent: true\n      });\n    };\n\n    _this._renderMovie = function () {\n      var movies = _this.state.movies.map(function (movie) {\n        return React.createElement(Movie, {\n          title: movie.title,\n          poster: movie.large_cover_image,\n          key: movie.id,\n          genres: movie.genres,\n          summary: movie.summary,\n          rating: movie.rating,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 49\n          },\n          __self: this\n        });\n      });\n\n      return movies;\n    };\n\n    _this._getMovies =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(pageNum) {\n        var movies;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this._callApi(pageNum);\n\n              case 2:\n                movies = _context.sent;\n\n                if (pageNum === 1) {\n                  _this.setState({\n                    movies: movies\n                  });\n                } else {\n                  _this.setState({\n                    movies: _this.state.movies.concat(movies)\n                  });\n                }\n\n                _this.setState({\n                  requestSent: false\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this._callApi = function (pageNum) {\n      return fetch('https://yts.am/api/v2/list_movies.json?sort_by=download_count&page=' + pageNum).then(function (response) {\n        if (!response.redirected) {\n          return response.json().then(function (json) {\n            return json.data.movies;\n          });\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this._loading = function (text) {\n      return React.createElement(\"div\", {\n        className: \"Loading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, text);\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._getMovies(1);\n\n      window.addEventListener('scroll', this._handleOnScroll);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('scroll', this._handleOnScroll);\n    } // scroll check\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var movies = this.state.movies;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: movies.length !== 0 ? \"App\" : \"App--loading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, movies.length !== 0 ? this._renderMovie() : \"Loading...\"));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/lonnie/Documents/movie_app/src/App.js"],"names":["React","Component","Movie","App","state","requestSent","pageNum","movies","_handleOnScroll","scrollTop","document","documentElement","body","scrollHeight","clientHeight","window","innerHeight","scrolledToBottom","Math","ceil","_querySearchResult","setState","_getMovies","_renderMovie","map","movie","title","large_cover_image","id","genres","summary","rating","_callApi","concat","fetch","then","response","redirected","json","data","catch","err","console","log","_loading","text","addEventListener","removeEventListener","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport Movie from './Movie';\n\nclass App extends Component {\n  // Render: componentWillMount() -> render() -> componentDidMount()\n  // Update: componentWillReceiveProps() -> shouldComponentUpdate() == true -> componentwillUpdate() -> render() -> componentDidUpdate()\n\n  state = {\n    requestSent: false,\n    pageNum: 1,\n    movies: []\n  }\n\n  componentDidMount(){\n    this._getMovies(1)\n    window.addEventListener('scroll', this._handleOnScroll);\n  }\n  componentWillUnmount(){\n    window.removeEventListener('scroll', this._handleOnScroll);\n  }\n\n  // scroll check\n  _handleOnScroll = () => {\n    // http://stackoverflow.com/questions/9439725/javascript-how-to-detect-if-browser-window-is-scrolled-to-bottom\n    var scrollTop = (document.documentElement && document.documentElement.scrollTop) || document.body.scrollTop;\n    var scrollHeight = (document.documentElement && document.documentElement.scrollHeight) || document.body.scrollHeight;\n    var clientHeight = document.documentElement.clientHeight || window.innerHeight;\n    var scrolledToBottom = Math.ceil(scrollTop + clientHeight) >= scrollHeight;\n\n    if (scrolledToBottom) {\n      this._querySearchResult();\n    }\n  }\n\n  _querySearchResult = () => {\n      if (this.state.requestSent) {\n        return;\n      }\n      this.setState({\n        pageNum: this.state.pageNum + 1\n      })\n      this._getMovies(this.state.pageNum);\n      this.setState({requestSent: true});\n  }\n\n  _renderMovie = () => {\n    const movies = this.state.movies.map((movie) => {\n      return <Movie \n        title={movie.title} \n        poster={movie.large_cover_image} \n        key={movie.id} \n        genres={movie.genres} \n        summary={movie.summary} \n        rating={movie.rating} \n      />\n    })\n    return movies\n  }\n\n  _getMovies = async (pageNum) => {\n    const movies = await this._callApi(pageNum)\n    if(pageNum === 1){\n      this.setState({\n        movies\n      })\n    } else {\n      this.setState({\n        movies : this.state.movies.concat(movies)\n        \n      })\n    }\n    this.setState({requestSent: false});\n  }\n\n  _callApi = (pageNum) => {\n    return fetch('https://yts.am/api/v2/list_movies.json?sort_by=download_count&page=' + pageNum)\n    .then(function(response) {\n      if(!response.redirected){\n        return response.json()\n        .then(json => json.data.movies)\n      }\n    })\n    .catch(err => console.log(err))\n  }\n  \n  _loading = (text) => {\n    return (\n      <div className=\"Loading\">{text}</div>\n    )\n  }\n  render() {\n    const { movies } = this.state\n    \n    return (\n      <div>\n      <div className={movies.length !== 0 ? \"App\" : \"App--loading\"}>\n        \n        {movies.length !== 0 ? this._renderMovie() : \"Loading...\"}\n\n      </div>\n      \n      </div>\n    );\n  }\n\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}